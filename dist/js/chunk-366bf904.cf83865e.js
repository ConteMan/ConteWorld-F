(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-366bf904"],{"0b22":function(e,t,n){"use strict";n.r(t);var a=n("1da1"),r=n("5530"),o=(n("d3b7"),n("caad"),n("b0c0"),n("96cf"),n("ac0d")),i=n("2f62"),s=n("9fb0"),l={name:"Share",mixins:[o.d],props:{type:{type:String,default:""},slug:{type:String,default:""}},data:function(){return{loading:!0,file:{},jsonData:{}}},methods:Object(r.a)(Object(r.a)({},Object(i.b)("app",{loadingAction:s.j})),{},{bookmarkChange:function(e){var t=this;return Object(a.a)(regeneratorRuntime.mark((function n(){var a,r,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.target.files[0],t.file=a,n.next=4,t.readFileAsync(a);case 4:r=n.sent,o=t.domDeal(r),t.jsonData=t.bookmarkDomToJson(o.body);case 7:case"end":return n.stop()}}),n)})))()},opmlChange:function(e){var t=this;return Object(a.a)(regeneratorRuntime.mark((function n(){var a,r,o,i,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.target.files[0],t.file=a,n.next=4,t.readFileAsync(a);case 4:r=n.sent,o=t.domDeal(r,"application/xml"),i=o.querySelector("opml").getAttribute("version"),s=t.opmlDomToJson(o.querySelector("body")),t.jsonData={version:i,data:s};case 9:case"end":return n.stop()}}),n)})))()},domDeal:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text/html",n=new DOMParser,a=n.parseFromString(e,t);return a},readFileAsync:function(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(){t(a.result)},a.onerror=n,a.readAsText(e)}))},bookmarkDomToJson:function(e){if(!e)return null;var t,n=e.nodeName.toLowerCase();if(t=["dl"].includes(n)?[]:{},["dt"].includes(n)&&"a"===e.childNodes[0].nodeName.toLowerCase()){var a=e.childNodes[0];return t.title=a.innerHTML,t.url=a.getAttribute("href"),t.addDate=this.$dayjs.unix(a.getAttribute("add_date")).format("YYYY-MM-DD HH:mm:ss"),t}for(var r=0;r<e.childNodes.length;r++){var o=e.childNodes[r],i=o.nodeName.toLowerCase();["h1","h2","h3"].includes(i)&&(t.name=o.innerHTML,o.getAttribute("add_date")&&(t.addDate=this.$dayjs.unix(o.getAttribute("add_date")).format("YYYY-MM-DD HH:mm:ss")),o.getAttribute("last_modified")&&(t.lastModified=this.$dayjs.unix(o.getAttribute("last_modified")).format("YYYY-MM-DD HH:mm:ss"))),["dt"].includes(i)&&t.push(this.bookmarkDomToJson(o)),["dl"].includes(i)&&(t.children=this.bookmarkDomToJson(o))}return t},opmlDomToJson:function(e){if(!e)return null;for(var t=["text","title","type","xmlUrl","htmlUrl"],n={},a=e.attributes,r=0;r<a.length;r++){var o=a[r];t.includes(o.name)&&(n[o.name]=o.value)}if(e.hasChildNodes()){n.children=[];for(var i=0;i<e.childNodes.length;i++){var s=e.childNodes[i];"outline"===s.nodeName&&n.children.push(this.opmlDomToJson(s))}}return n}})},c=(n("cfe8"),n("2877")),u=Object(c.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"share-container"},[n("div",{staticClass:"back"},[n("a-icon",{attrs:{type:"left"},on:{click:function(t){return e.$router.push({path:"/"+e.type})}}})],1),n("div",{staticClass:"content"},[n("div",{staticClass:"file-input-container"},[n("button",{on:{click:function(){return e.$refs.bookmarkFileInput.click()}}},[e._v("选择书签文件转换为 JSON 格式")]),n("input",{ref:"bookmarkFileInput",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:e.bookmarkChange}})]),n("div",{staticClass:"file-input-container"},[n("button",{on:{click:function(){return e.$refs.opmlFileInput.click()}}},[e._v("选择 OPML 文件转换为 JSON 格式")]),e.file.name?n("div",{staticClass:"file-name"},[e._v(e._s(e.file.name))]):e._e(),n("input",{ref:"opmlFileInput",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:e.opmlChange}})]),Object.keys(e.jsonData).length>0?n("div",{staticClass:"json"},[n("pre",{staticClass:"json-pre",domProps:{innerHTML:e._s(JSON.stringify(e.jsonData,null,2))}})]):e._e()])])}),[],!1,null,"7170a390",null);t.default=u.exports},cfe8:function(e,t,n){"use strict";n("e33b")},e33b:function(e,t,n){}}]);